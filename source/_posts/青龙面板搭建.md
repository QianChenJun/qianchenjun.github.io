---
title: 青龙面板搭建
tags:
  - 青龙面板
categories:
  - VPS
abbrlink: 329c3308
date: 2023-03-17 10:10:45
updated: 2023-03-17 10:10:45
---

# 青龙面板搭建

## 安装docker

[docker安装教程参考菜鸟教程](https://www.runoob.com/docker/ubuntu-docker-install.html)



## 青龙面板

### 安装docker镜像

```docker
docker pull whyour/qinglong:latest 
```



### 启动docker镜像

```
docker run -dit \
   -v $PWD/ql/config:/ql/config \
   -v $PWD/ql/log:/ql/log \
   -v $PWD/ql/db:/ql/db \
   -v $PWD/ql/scripts:/ql/scripts \
   -p 5700:5700 \
   --name qinglong \
   --hostname qinglong \
   --restart always \
   whyour/qinglong:latest
```



### 配置青龙基本信息

这个时候青龙面板已经启动完毕，地址为`IP+端口`，需要配置一些基本信息。

![image-20230317013318782](https://qianchen-image.oss-cn-beijing.aliyuncs.com/blog/image-20230317013318782.png)

#### 安装依赖-自动安装

首先进入青龙的容器：`docker exec -it ql bash `

粘贴如下代码即可

```
curl -fsSL https://ghproxy.com/https://raw.githubusercontent.com/bean661/utils/main/QLOneKeyDependency.sh | sh
curl -fsSL https://ghproxy.com/https://raw.githubusercontent.com/bean661/utils/main/QLOneKeyDependency_easy.sh | sh
```

#### 手动安装依赖

> 在青龙面板配置

![image-20230317013613738](https://qianchen-image.oss-cn-beijing.aliyuncs.com/blog/image-20230317013613738.png)

```
1. Nodejs（不要复制这个）
crypto-js
prettytable
dotenv
jsdom
date-fns
tough-cookie
tslib
ws@7.4.3
ts-md5
jsdom -g
jieba
fs
form-data
json5
global-agent
png-js
@types/node
require
typescript
js-base64
axios

2. Python3（不要复制这个）
requests
canvas
ping3
jieba
aiohttp
PyExecJS

3. Linux（不要复制这个）
bizCode
lxml
bizMsg
```



#### 创建应用配置

![image-20230317015659824](https://qianchen-image.oss-cn-beijing.aliyuncs.com/blog/image-20230317015659824.png)

### 拉取常见脚本库

#### Faker3(不含助力)

```
ql repo https://github.com/shufflewzc/faker3.git "jd_|jx_|gua_|jddj_|jdCookie" "activity|backUp" "^jd[^_]|USER|function|utils|sendNotify|ZooFaker_Necklace.js|JDJRValidator_|sign_graphics_validate|ql|JDSignValidator" "main"
```

![image-20230317013852521](https://qianchen-image.oss-cn-beijing.aliyuncs.com/blog/image-20230317013852521.png)







### 配置sallyGirl

1. 国内用户

   ```
   s=sillyGirl;a=arm64;if [[ $(uname -a | grep "x86_64") != "" ]];then a=amd64;fi ;if [ ! -d $s ];then mkdir $s;fi ;cd $s;wget http://github.yanyuge.workers.dev/https://github.com/cdle/${s}/releases/download/main/${s}_linux_$a -O $s && chmod 777 $s;pkill -9 $s;$(pwd)/$s
   ```

2. 国外用户

   ```
   s=sillyGirl;a=arm64;if [[ $(uname -a | grep "x86_64") != "" ]];then a=amd64;fi ;if [ ! -d $s ];then mkdir $s;fi ;cd $s;wget https://github.com/cdle/${s}/releases/download/main/${s}_linux_$a -O $s && chmod 777 $s;pkill -9 $s;$(pwd)/$s
   ```

安装完成后按照如下操作即可（交互式操作）

```
cd /etc/sillyGirl
./sillyGirl -t

# 设置端口
set sillyGirl port 9090

# 设置主人账号
set qq masters 你的管理QQ号

# 开启http服务
set sillyGirl enable_http_server true

...
基本配置完成后记得输入《重启》
```

[傻妞命令大全](https://blog.csdn.net/m0_51607907/article/details/123871720)

> 这个时候傻妞就配置的差不多了，后续对接了QQ后可以用管理员操作命令

### 配置pm2

#### 安装node

```
apt-get install nodejs
```



#### 安装npm

```
apt-get install npm
npm --version
```



#### 更新node（可选）

```
npm cache clean -f
npm install -g n
n stable
node -v
```

> 注：如果当前版本没有变化的话，可以重新打开服务器再看一下



#### 安装pm2

```
npm install -g pm2
```



### 配置one-bot

#### 下载one-bot

```
cd ~ && git clone https://github.com/takayama-lily/node-onebot.git
mv node-onebot one-bot
```

#### 修改配置文件

在one-bot的安装目录下存在config.sample.js，将其修改成config.js，然后编辑其内容。

![image-20230317014908365](https://qianchen-image.oss-cn-beijing.aliyuncs.com/blog/image-20230317014908365.png)

内容模板（修改端口+QQ）

```
module.exports = {
    //通用配置
    general: {
        platform:           2,      //1:安卓手机 2:aPad 3:安卓手表 4:MacOS 5:iPad
        debug:              false,  //开启debug
        use_cqhttp_notice:  true,   //是否使用cqhttp标准的notice事件格式
        host:               "localhost",  //监听主机名
        port:               青龙端口,       //端口
        use_http:           false,      //启用http
        use_ws:             false,      //启用正向ws，和http使用相同地址和端口
        access_token:       "",         //访问api的token
        secret:             "",         //上报数据的sha1签名密钥
        post_timeout:       30,         //post超时时间(秒)
        post_message_format:"array",    //"string"或"array"
        enable_cors:        false,      //是否允许跨域请求
        enable_heartbeat:   false,      //是否启用ws心跳
        heartbeat_interval: 15000,      //ws心跳间隔(毫秒)
        rate_limit_interval:500,        //使用_rate_limited后缀限速调用api的排队间隔时间(毫秒)
        event_filter:       "",         //json格式的事件过滤器文件路径
        post_url: [ //上报地址，可以添加多个url
            // "http://your.address.com:80",
        ],
        ws_reverse_url: [ //反向ws地址，可以添加多个url
            "ws://localhost:傻妞配置的端口/qq/receive",
        ],
        ws_reverse_reconnect_interval: 3000, //反向ws断线重连间隔(毫秒)，设为负数直接不重连
        ws_reverse_reconnect_on_code_1000: true, //反向ws是否在关闭状态码为1000的时候重连
    },
    //每个账号的单独配置(用于覆盖通用配置)
    QQ号: {
    },
};
```

#### 配置机器人QQ

在one-node目录下使用命令`node main QQ号`进入交互式命令行，第一次会完成基本QQ的配置，完成后退出即可。



### pm2 启动程序

1. 进入傻妞的安装目录`/etc/sillyGirl`

   ```
   pm2 start sillyGirl
   ```

2. 进入one-bot安装目录`/root/onebot`

   ```
   pm2 start "node main QQ号"
   ```



### 对接青龙

使用管理员账号给机器人发送**青龙管理**，后续按照提示操作即可。
